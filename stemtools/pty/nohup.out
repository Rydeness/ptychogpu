/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of rotate is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of affine_transform is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of map_coordinates is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
Traceback (most recent call last):
  File "t2.py", line 9, in <module>
    n2 = acc.gpu_rot4D(n1,55)
  File "/gpfs/wolf/gen135/scratch/7dm/stemtools/stemtools/pty/acc_image_utils.py", line 38, in gpu_rot4D
    rot4D = cp.asnumpy(csnd.rotate(cu4D.reshape(-1, data_shape[-2], data_shape[-1]), rotangle, axes=(1,2), reshape=False))        
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 351, in rotate
    mode, cval, prefilter)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 242, in affine_transform
    prefilter).reshape(output_shape)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 112, in map_coordinates
    coordinates_floor = cupy.floor(coordinates).astype(cupy.int32)
  File "cupy/core/_kernel.pyx", line 831, in cupy.core._kernel.ufunc.__call__
  File "cupy/core/_kernel.pyx", line 339, in cupy.core._kernel._get_out_args
  File "cupy/core/core.pyx", line 134, in cupy.core.core.ndarray.__init__
  File "cupy/cuda/memory.pyx", line 518, in cupy.cuda.memory.alloc
  File "cupy/cuda/memory.pyx", line 1085, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 1106, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 934, in cupy.cuda.memory.SingleDeviceMemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 949, in cupy.cuda.memory.SingleDeviceMemoryPool._malloc
  File "cupy/cuda/memory.pyx", line 697, in cupy.cuda.memory._try_malloc
cupy.cuda.memory.OutOfMemoryError: out of memory to allocate 6442450944 bytes (total 19864225792 bytes)
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of rotate is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of affine_transform is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of map_coordinates is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
Traceback (most recent call last):
  File "t2.py", line 9, in <module>
    n2 = acc.gpu_rot4D(n1,55)
  File "/gpfs/wolf/gen135/scratch/7dm/stemtools/stemtools/pty/acc_image_utils.py", line 38, in gpu_rot4D
    rot4D = cp.asnumpy(csnd.rotate(cu4D.reshape(-1, data_shape[-2], data_shape[-1]), rotangle, axes=(1,2), reshape=False))        
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 351, in rotate
    mode, cval, prefilter)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 242, in affine_transform
    prefilter).reshape(output_shape)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 112, in map_coordinates
    coordinates_floor = cupy.floor(coordinates).astype(cupy.int32)
  File "cupy/core/_kernel.pyx", line 831, in cupy.core._kernel.ufunc.__call__
  File "cupy/core/_kernel.pyx", line 339, in cupy.core._kernel._get_out_args
  File "cupy/core/core.pyx", line 134, in cupy.core.core.ndarray.__init__
  File "cupy/cuda/memory.pyx", line 518, in cupy.cuda.memory.alloc
  File "cupy/cuda/memory.pyx", line 1085, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 1106, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 934, in cupy.cuda.memory.SingleDeviceMemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 949, in cupy.cuda.memory.SingleDeviceMemoryPool._malloc
  File "cupy/cuda/memory.pyx", line 697, in cupy.cuda.memory._try_malloc
cupy.cuda.memory.OutOfMemoryError: out of memory to allocate 6442450944 bytes (total 19864225792 bytes)
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of rotate is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of affine_transform is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of map_coordinates is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
Traceback (most recent call last):
  File "t2.py", line 9, in <module>
    n2 = acc.gpu_rot4D(n1,55)
  File "/gpfs/wolf/gen135/scratch/7dm/stemtools/stemtools/pty/acc_image_utils.py", line 38, in gpu_rot4D
    rot4D = cp.asnumpy(csnd.rotate(cu4D.reshape(-1, data_shape[-2], data_shape[-1]), rotangle, axes=(1,2), reshape=False))        
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 351, in rotate
    mode, cval, prefilter)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 242, in affine_transform
    prefilter).reshape(output_shape)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 112, in map_coordinates
    coordinates_floor = cupy.floor(coordinates).astype(cupy.int32)
  File "cupy/core/_kernel.pyx", line 831, in cupy.core._kernel.ufunc.__call__
  File "cupy/core/_kernel.pyx", line 339, in cupy.core._kernel._get_out_args
  File "cupy/core/core.pyx", line 134, in cupy.core.core.ndarray.__init__
  File "cupy/cuda/memory.pyx", line 518, in cupy.cuda.memory.alloc
  File "cupy/cuda/memory.pyx", line 1085, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 1106, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 934, in cupy.cuda.memory.SingleDeviceMemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 949, in cupy.cuda.memory.SingleDeviceMemoryPool._malloc
  File "cupy/cuda/memory.pyx", line 697, in cupy.cuda.memory._try_malloc
cupy.cuda.memory.OutOfMemoryError: out of memory to allocate 6442450944 bytes (total 19864225792 bytes)
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of rotate is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of affine_transform is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py:27: UserWarning: In the current feature the default order of map_coordinates is 1. It is different from scipy.ndimage and can change in the future.
  'the future.'.format(func_name))
Traceback (most recent call last):
  File "t2.py", line 9, in <module>
    n2 = acc.gpu_rot4D(n1,55)
  File "/gpfs/wolf/gen135/scratch/7dm/stemtools/stemtools/pty/acc_image_utils.py", line 38, in gpu_rot4D
    rot4D = cp.asnumpy(csnd.rotate(cu4D.reshape(-1, data_shape[-2], data_shape[-1]), rotangle, axes=(1,2), reshape=False))        
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 351, in rotate
    mode, cval, prefilter)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 242, in affine_transform
    prefilter).reshape(output_shape)
  File "/gpfs/wolf/gen135/scratch/7dm/anaconda3/lib/python3.7/site-packages/cupyx/scipy/ndimage/interpolation.py", line 112, in map_coordinates
    coordinates_floor = cupy.floor(coordinates).astype(cupy.int32)
  File "cupy/core/_kernel.pyx", line 831, in cupy.core._kernel.ufunc.__call__
  File "cupy/core/_kernel.pyx", line 339, in cupy.core._kernel._get_out_args
  File "cupy/core/core.pyx", line 134, in cupy.core.core.ndarray.__init__
  File "cupy/cuda/memory.pyx", line 518, in cupy.cuda.memory.alloc
  File "cupy/cuda/memory.pyx", line 1085, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 1106, in cupy.cuda.memory.MemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 934, in cupy.cuda.memory.SingleDeviceMemoryPool.malloc
  File "cupy/cuda/memory.pyx", line 949, in cupy.cuda.memory.SingleDeviceMemoryPool._malloc
  File "cupy/cuda/memory.pyx", line 697, in cupy.cuda.memory._try_malloc
cupy.cuda.memory.OutOfMemoryError: out of memory to allocate 6442450944 bytes (total 19864225792 bytes)
